"use strict";$(function(){var e=JSON.parse($("#poll-json").text());$(".poll-subject").loadTemplate("#template-poll-subject",{title:e.poll.title,expiry:e.poll.expiry});for(var t=[],o=0;o<e.questions.length;o++){for(var n=e.questions[o],a=[],r=0;r<e.options.length;r++){var l=e.options[r],p=$(document.createDocumentFragment());p.loadTemplate("#template-poll-option",{optionId:"answers["+n.id+"]["+l.id+"]",optionTag:"answers-"+n.id+"-"+l.id,min:e.poll.point_min,max:e.poll.point_max,answer:(e.answers[n.id]||{})[l.id]||e.point_default,label:l.label,voted:e.voted}),a[a.length]=p}var s=$(document.createDocumentFragment());s.loadTemplate("#template-poll-question",{label:n.label}),s.find(".options").append(a),t[t.length]=s}var i=$($("#template-poll-body")[0].content).clone();i.find(".questions").append(t),$(".poll-body").append(i),$("#form").on("submit",function(e){e.preventDefault(),$(".errors").empty();var t=$(this);return $.ajax({url:t.prop("action"),method:t.prop("method"),headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:t.serialize(),dataType:"json"}).done(function(e){console.log(e),document.location=e.url}).fail(function(e,t,o){var n=""+e.responseText;if(""!==n)try{null!=(n=JSON.parse(n)).message&&(o=n.message),console.log(n)}catch(e){}if($(".errors").empty(),n.errors)for(var a in n.errors)$(".errors.target-"+a).append(n.errors[a]);$(".error-submit").append("["+t+"]"+o)}),!1}).on("change",".answers",function(e){var o=this,t=$(this),n=t.data("target"),a=t.val();$("."+n).each(function(e,t){o!==t&&$(t).val(a)})})});